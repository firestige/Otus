# Otus Global Configuration
# This configuration is loaded once at startup and defines system-wide settings.
# For task-specific configuration, use TaskConfig JSON from Kafka commands or CLI.

# Daemon configuration
daemon:
  pid_file: "/var/run/otus.pid"       # PID file location
  socket_path: "/var/run/otus.sock"   # Unix socket for local RPC communication

# Logging configuration
log:
  level: "info"                        # Log level: debug, info, warn, error
  format: "json"                       # Log format: json or text
  outputs:                             # Multiple output destinations
    # Console output (stdout)
    - type: "console"
      enabled: true

    # File output
    - type: "file"
      enabled: true
      path: "/var/log/otus/otus.log"
      max_size: 100                    # MB per file
      max_age: 30                      # Days to keep
      max_backups: 10                  # Number of backup files
      compress: true                   # Compress old files

    # Loki output (log aggregation)
    - type: "loki"
      enabled: false
      url: "http://localhost:3100/loki/api/v1/push"
      batch_size: 100
      timeout: "10s"
      labels:
        service: "otus"
        environment: "production"

# Kafka configuration (for command receiving and log output)
kafka:
  brokers:                             # Kafka broker addresses
    - "localhost:9092"
  command_topic: "otus-commands"       # Topic for receiving capture tasks
  command_group: "otus-agents"         # Consumer group for command topic
  log_topic: "otus-logs"               # Topic for structured logs (optional)
  sasl:
    enabled: false
    mechanism: "PLAIN"                 # PLAIN, SCRAM-SHA-256, SCRAM-SHA-512
    username: ""
    password: ""
  tls:
    enabled: false
    ca_cert: ""
    client_cert: ""
    client_key: ""
    insecure_skip_verify: false

# Metrics configuration (Prometheus)
metrics:
  enabled: true
  listen: "0.0.0.0:9090"               # Prometheus metrics HTTP endpoint
  path: "/metrics"                     # Metrics endpoint path

# Agent identification
agent:
  id: ""                               # Agent ID (auto-generated from hostname if empty)
  tags:                                # Custom tags for agent identification
    datacenter: "dc1"
    region: "us-west-1"
    environment: "production"
